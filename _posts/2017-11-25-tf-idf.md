---
title: "[알고리즘]TF-IDF(단어 빈도-역문서 빈도)"
last_modified_at: 2017-11-25T18:00:34-00:00
categories: 
  - Algorithm
  - AI
  - ML
tags:
  - NLP
  - Machine Learning
---

TF-IDF는 어떤 단어가 특정 문서 내에서 얼마나 중요한지를 나타내는 통계적 수치로 텍스트 마이닝이나 정보검색에서 많이 이용하는 알고리즘이다. TF-IDF를 계산하면 단어를 벡터화 하거나 문서를 벡터화 할 수 있기 때문에 다양한 용도로 사용할 수 있다. 예를 들어 검색결과 순위를 결정하거나 문서들 사이의 유사도를 구하는 등의 여러가지에 이용될 수 있다. TF-IDF는 TF(단어 빈도)와 IDF(역문서 빈도)의 곱으로 계산 방법은 다양하다. 단어 빈도와 역문서 빈도를 한번 알아보도록 하자.

<br>

### 단어 빈도(Term Frequency)

**단어 빈도**는 어떤 문서 내에서 특정 단어가 얼마나 이용되었는지 나타내는 척도로 $tf(t, d)$로 표현한다. 단어 빈도는 단순하게 특정 문서 내 단어의 갯수를 이용할 수도 있고 다른 방법들을 이용 할 수도 있다. 단순한 단어의 갯수를 보통 $f(t, d)$라고 표현한다.  몇가지 단어 빈도를 표현할 수 있는 방법들을 알아보자. 

- **불린빈도**:  불린빈도는 어떤 문서에 특정 단어가 있는지 없는지를 표현한다. 특정 단어가 있으면 1, 없으면 0으로 단어 빈도 함수를 만들 수 있다.

- **로그 스케일 빈도**: 로그 스케일 빈도는 단순 단어 빈도에 로그를 취해 스케일링을 해주는 방법이다. 이때, $f(t, d)$가 0이 될 수 있기 때문에 1을 더한 후에 로그를 취한다. $tf(t, d) = log(1 + f(t, d))$

- **증가 빈도**: 증가 빈도는 아마도 많이 사용되는 단어 빈도 계산법 중 하나일 것이다. 증가빈도는 문서의 길이에 따라 단어의 빈도값이 달라진다. 수식을 보면 다음과 같다.

  $tf(t, d) = 0.5 + {0.5 \times f(t, d) \over 해당 문서에서 가장 많은 단어의 수}$ 

  즉, 문서에서 가장 많이 쓰인 단어의 빈도로 특정 단어의 빈도를 나눠준다. 어떤 문장에서 가장 빈도가 높은 단어에 대한 상대적 빈도를 표현할 수 있는 식이다.

<br>

### 역문서 빈도(Inverse Document Frequency)

**역문서 빈도**는 어떤 단어가 문서 전체 집합에서 얼마나 많이 나오는지 나타내는 값으로 $idf(t, D)$로 표현한다. 단어빈도가 필요한 것은 당연해 보이지만 역문서 빈도는 언뜻 바로 이해되지 않을 수도 있다. 예를 들어 많은 문서에 "학교"이라는 단어가 나온다면 "학교"이라는 단어는 상대적으로 중요도가 떨어질 것이다. 하지만 다른 문서에는 나오지 않는 "중앙대학교"가 어떤 문서에 나오게 된다면 그 문서에서 특정 단어(중앙대학교)의 중요도는 높아진다.

또 역문서 빈도는 한국어에서 조사, 영어에서 is, the 처럼 큰 의미없이 많이 사용되는 단어들의 점수를 낮춰준다. 보통 이런 단어들을 stop word(불용어)라고 부른다.

역문서 빈도는 전체 문서의 수를 해당 단어를 포함하는 문서의 수로 나눈 후 로그를 취해서 얻는다.   

$$idf(t, D) = {전체 문서의 수 \over t 단어가 포함된 문서의 수}$$



단어 빈도와 역문서 빈도를 구한 후에 두 값을 곱하면 TF-IDF값을 얻을 수 있다.

<br>

### 문서길이 가중치(Norm)

**문서길이 가중치**는 최근 TF-IDF계열 검색방법에서 이용되는 term중에 하나이다. 문서의 길이가 길어지면 이 문서에서 특정한 단어가 중요한 역할을 하기 어려워진다. 

예를 들어 "나는 새우튀김을 먹는다."와 "영희는 새우튀김과 닭튀김을 먹는다."라는 문장이 있다고 하자. 새우튀김을 검색하면  "나는 새우튀김을 먹는다."라는 문장이 "영희는 새우튀김과 닭튀김을 먹는다."에 대한 문장보다 새우튀김을 더 중요하게 다뤘다고 볼 수 있다. 하지만 두 문장은 단어 빈도나 역문서 빈도는 똑같이 나올 것이다. 문서길이 가중치는 앞의 문장이 더 높은 스코어를 갖게 만들어준다.

<br>

### BM25 알고리즘

**BM25**알고리즘은 단어빈도, 역문서빈도, 문서길이 가중치를 이용해서 만들어진 검색 알고리즘이다. 아래와 같은 식으로 점수를 매기고서 점수가 높은 문서를 검색하는 방식이다.

$Score(D, Q) = \Sigma^n_{i=1}IDF(q_i) \cdot {f(q_i, D) \cdot k_1+1 \over f(q_i, D) + k_1 \cdot (1-b+b\cdot {문서의 길이 \over 문서들의 평균 길이} )}$

위 식에서 $f(q_i, D)$는 문서 D에서 $q_i$라는 단어의 단어빈도이다. 위 식에서 역문서 빈도는 다음과 같이 나타낸다.

$IDF(q_i) = log({문서 갯수 - q_i를 포함하는 문서 + 0.5 \over q_i를 포함하는 문서 + 0.5})$

실제 많은 검색알고리즘에서 BM25알고리즘의 변형을 채택해 이용하고 있다.



### 참조

[TF-IDF - 위키피디아](https://en.wikipedia.org/wiki/Tf%E2%80%93idf)  
[TF-IDF(Term Frequency - Inverse Document Frequency) / 단어 빈도와 역문서 빈도.](http://dev.youngkyu.kr/25)

